<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" data-namespace-typo3-fluid="true">

<f:section name="content"><f:format.raw>{<f:format.raw/>
    "name": {location.name -> f:format.json()},
    "hidden": 0,
    "lat": {location.latitude},
    "lng": {location.longitude},
    "information": {<f:format.raw/>
        "uid": {location.uid},
        "lat": {location.latitude},
        "lng": {location.longitude},
        "name": {location.name -> f:format.json()},
        "storeid": {location.storeid -> f:format.json()},
        "address": {location.address -> f:format.json()},
        "additionaladdress": {location.additionaladdress -> f:format.json()},
        "city": {location.city -> f:format.json()},
        "person": {location.person -> f:format.json()},
        "zipcode": {location.zipcode -> f:format.json()},
        "products": {location.products -> f:format.json()},
        "email": {location.email -> f:format.json()},
        "phone": {location.phone -> f:format.json()},
        "mobile": {location.mobile -> f:format.json()},
        "fax": {location.fax -> f:format.json()},
        "hours": {location.hours -> f:format.json()},
        "url": {f:uri.typolink(parameter: location.url) -> f:format.json()},
        "notes": {location.notes -> f:format.json()},
        "state": {location.state.localName -> f:format.json()},
        "country": {location.country.shortNameLocal -> f:format.json()},
        "icon": <f:render section="icon" arguments="{icon: location.icon}"/>,
        "media": <f:render section="images" arguments="{images: location.media, render: true}"/>,
        "image": <f:render section="images" arguments="{images: location.image, render: settings.showStoreImage}"/>,
        "layer": <f:render section="fileUrl" arguments="{files: location.layer}"/>,
        "attributes": <f:render section="uids" arguments="{records: location.attributes}"/>
    }
}</f:format.raw></f:section>

<f:section name="icon"><f:format.raw>
    <f:format.json><f:if condition="{icon.0}">{f:uri.image(image: icon.0)}</f:if></f:format.json>
</f:format.raw></f:section>

<f:section name="images"><f:format.raw>[
    <f:if condition="{images -> f:count()} && {render}">
        <f:for each="{images}" as="image" iteration="iterator">{f:uri.image(image: image, width: 70) -> f:format.json()}<f:if condition="!{iterator.isLast}">, </f:if></f:for>
    </f:if>
]</f:format.raw></f:section>

<f:section name="fileUrl"><f:format.raw>
    <f:format.json><f:if condition="{files -> f:count()}">/{files.0.originalResource.publicUrl}</f:if></f:format.json>
</f:format.raw></f:section>

<f:section name="uids"><f:format.raw>[
    <f:if condition="{records -> f:count()}">
        <f:then><f:for each="{records}" as="record" iteration="iterator">
            {record.uid}<f:if condition="!{iterator.isLast}">, </f:if>
        </f:for></f:then>
    </f:if>
]</f:format.raw></f:section>

</html>
